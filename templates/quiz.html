{% extends "base.html" %}

{% block content %}
    {% if error %}
        <div class="flash is-error">
            <p>Error generating quiz: {{ error }}</p>
            <p><a class="link-inline" href="{{ url_for('index') }}">Try again with another topic</a></p>
        </div>
        <div class="quiz-actions">
            <a class="btn btn-ghost" href="{{ url_for('index') }}">Back to generator</a>
        </div>
    {% else %}
        <section class="quiz-header">
            <p class="eyebrow">Quiz generated</p>
            <h2>{{ topic }} quiz</h2>
            <p class="quiz-subtitle">Select an answer to reveal the correct response. Use this set for warm-ups, lightning talks, or self-study.</p>
        </section>

        <div class="quiz-list">
            {% for question in questions %}
                <article class="quiz-card">
                    <div class="question-header">
                        <span class="question-index">Q{{ loop.index }}</span>
                        <p class="question-text">{{ question.text }}</p>
                    </div>

                    <div class="options">
                        {% for option in question.options %}
                            <div class="option">
                                <input
                                    class="sr-only"
                                    type="radio"
                                    id="q{{ question.number }}{{ option.letter }}"
                                    name="q{{ question.number }}"
                                    value="{{ option.letter }}">
                                <label class="option-label" for="q{{ question.number }}{{ option.letter }}">
                                    <span class="option-letter">{{ option.letter }}</span>
                                    <span class="option-body">{{ option.text }}</span>
                                </label>
                            </div>
                        {% endfor %}
                    </div>

                    <div class="answer-pill">
                        <span class="answer-label">Answer</span>
                        <span class="answer-value">{{ question.answer }}</span>
                    </div>
                </article>
            {% endfor %}
        </div>

        <div class="quiz-actions">
            <a class="btn btn-secondary" href="{{ url_for('index') }}">Create another quiz</a>
        </div>
    {% endif %}

    <script>
        const cards = document.querySelectorAll('.quiz-card');
        cards.forEach(card => {
            const radios = card.querySelectorAll('input[type="radio"]');
            const answer = card.querySelector('.answer-pill');
            if (!answer) {
                return;
            }
            radios.forEach(radio => {
                radio.addEventListener('change', () => {
                    answer.classList.add('is-visible');
                });
            });
        });
    </script>
{% endblock %}